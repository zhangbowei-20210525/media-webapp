<div *ngIf="isLoaded" [@fadeIn]>
  <div nz-row style="margin-bottom: 1.5rem;">
    <div nz-col nzSpan="18">
      <div class="left-options">
        <form nz-form [formGroup]="filtrateForm" style="width: 100%;">

          <nz-form-item style="margin-bottom: 0;">
            <nz-form-label nzFor="investment_type" [nzSpan]="2">投资类型</nz-form-label>
            <nz-form-control>
              <nz-radio-group formControlName="investment_type" (ngModelChange)="onFormValueChange()">
                <label nz-radio-button [nzValue]="null">所有</label>
                <label nz-radio-button nzValue="homemade">自制</label>
                <label nz-radio-button nzValue="purchase">购入</label>
                <label nz-radio-button nzValue="proxy">代理</label>
                <label nz-radio-button nzValue="main-vote">主投</label>
                <label nz-radio-button nzValue="follow">跟投</label>
                <label nz-radio-button nzValue="co-production">合拍</label>
                <label nz-radio-button nzValue="contract">承制</label>
                <label nz-radio-button nzValue="introduction">引进</label>
              </nz-radio-group>
            </nz-form-control>
          </nz-form-item>

          <nz-form-item style="margin-bottom: 0;">
            <nz-form-label nzFor="program_type" [nzSpan]="2">节目类型</nz-form-label>
            <nz-form-control>
              <nz-select style="width: 445px" nzMode="multiple" nzPlaceHolder="请选择节目类型" formControlName="program_type"
                (ngModelChange)="onFormValueChange()">
                <nz-option *ngFor="let option of seriesType" [nzLabel]="option.label" [nzValue]="option.value">
                </nz-option>
              </nz-select>
              <!-- <nz-radio-group formControlName="program_type" (ngModelChange)="onFormValueChange()">
                  <label nz-radio-button [nzValue]="null">所有</label>
                  <label nz-radio-button nzValue="tv">电视剧</label>
                  <label nz-radio-button nzValue="film">电影</label>
                  <label nz-radio-button nzValue="variety">综艺</label>
                  <label nz-radio-button nzValue="other">其他</label>
                </nz-radio-group> -->
            </nz-form-control>
          </nz-form-item>

          <nz-form-item style="margin-bottom: 0;">
            <nz-form-label nzFor="area" [nzSpan]="2">地域</nz-form-label>
            <nz-form-control [nzSpan]="8">
              <nz-tree-select style="width: 445px" [nzNodes]="areaOptions" nzShowSearch nzCheckable
                nzPlaceHolder="请选择地域" formControlName="area" (ngModelChange)="onFormValueChange($event)">
              </nz-tree-select>
              <!-- <nz-cascader formControlName="area" [nzOptions]="areaOptions" nzLabelProperty="name"
                    nzValueProperty="code" nzPlaceHolder="筛选地区" nzChangeOnSelect nzAllowClear="false"
                    (ngModelChange)="onFormValueChange()" nzSize="default">
                  </nz-cascader> -->
            </nz-form-control>
          </nz-form-item>

          <nz-form-item style="margin-bottom: 0;">
            <nz-form-label nzFor="right" [nzSpan]="2">权利</nz-form-label>
            <nz-form-control [nzSm]="8">
              <nz-cascader formControlName="right" [nzOptions]="rightOptions" nzLabelProperty="name"
                nzValueProperty="code" nzChangeOnSelect nzAllowClear="false" (ngModelChange)="onFormValueChange()"
                nzSize="default">
              </nz-cascader>
            </nz-form-control>
            <nz-form-label nzFor="sole" [nzSpan]="2">独家</nz-form-label>
            <nz-form-control [nzSpan]="8">
              <label nz-checkbox formControlName="sole" (ngModelChange)="onFormValueChange()"></label>
            </nz-form-control>
          </nz-form-item>


          <nz-form-item style="margin-bottom: 0;">
            <nz-form-label nzFor="days" [nzSpan]="2">到期天数</nz-form-label>
            <nz-form-control [nzSpan]="8">
              <nz-select formControlName="days" (ngModelChange)="onFormValueChange()" nzSize="default">
                <nz-option nzValue="all" nzLabel="所有"></nz-option>
                <nz-option nzValue="365" nzLabel="一年"></nz-option>
                <nz-option nzValue="180" nzLabel="180天"></nz-option>
                <nz-option nzValue="30" nzLabel="30天"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>

          <nz-form-item style="margin-bottom: 0;">
            <nz-form-label nzFor="date" [nzSpan]="2">期限</nz-form-label>
            <nz-form-control [nzSpan]="8">
              <nz-range-picker formControlName="date" (ngModelChange)="onFormValueChange()" nzSize="default">
              </nz-range-picker>
            </nz-form-control>
          </nz-form-item>

          <nz-form-item style="margin-bottom: 0;">
            <nz-form-label nzFor="company_id" [nzSpan]="2">公司</nz-form-label>
            <nz-form-control [nzSpan]="8">
              <nz-select formControlName="company_id" nzAllowClear nzPlaceHolder="请选择公司"
                (ngModelChange)="onFormValueChange()">
                <nz-option *ngFor="let option of companyList" [nzLabel]="option.name" [nzValue]="option.id"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </form>
      </div>
    </div>
  </div>
  <div style="margin-top: 1.5rem;margin-bottom: 1.5rem">
    <nz-tag nzMode="closeable" (nzOnClose)="closeTag(tag)" *ngFor="let tag of tags">
      {{ tag.project }}
    </nz-tag>
  </div>
  <nz-table #dataTable nzBordered [nzData]="dataSet" [nzPageSize]="pagination.page_size" [nzFrontPagination]="false"
    [nzPageIndex]="pagination.page" [nzTotal]="pagination.count" (nzPageIndexChange)="copyrightsPageChange($event)">
    <thead>
      <tr>
        <th>#</th>
        <th>项目名称</th>
        <th>品类</th>
        <th>集数</th>
        <th>权利</th>
        <th>范围</th>
        <th>期限</th>
        <th>操作</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let data of dataTable.data;let i = index">
        <td>{{ i + 1 + pagination.page * 10 - 10}}</td>
        <td>
          {{data.program_name }}
        </td>
        <td>{{ data.program_type | seriesType | emptyDefaultChar }}</td>
        <td>{{ data.episode | emptyDefaultChar }}</td>
        <td>
          <span *ngIf="data.right_type == 'broadcast'">播映权</span>
          <span *ngIf="data.right_type == 'network'">信息网络传播权</span>
          <span *ngIf="data.right_type == 'publish'">出版发行权</span>
          <span *ngIf="data.right_type == 'public'">公播权</span>
        <td>{{ data.area_label }}</td>
        <td>
          {{ (data.permanent_date ? '永久' : (data.start_date && data.end_date)? ((data.start_date | date:'yyyy/MM/dd') + ' ~ ' +
            (data.end_date | date:'yyyy/MM/dd')) : data.date_remark) | emptyDefaultChar }}
        </td>
        <td>
          <a nz-popconfirm nzTitle="是否删除此节目所有权利？" (nzOnConfirm)="deleteSeriesCopyright(data.id)"><i class="text-info"
              nz-icon type="delete" theme="outline"></i></a>
        </td>
      </tr>
    </tbody>
  </nz-table>
</div>